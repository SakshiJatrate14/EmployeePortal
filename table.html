<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Employee Table</title>

</head>

<body>
    <script src="addData.js"></script>
    <table id="userTable" border="1">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Age</th>
                <th>URL</th>
                <th>Designation</th>
                <th>Gender</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody><!-- Table rows will be  generated here --></tbody>
    </table>
    <div id="popup">
        <div id="popup-content"></div>
    </div>

    <style>
        #userTable {
            width: 100%;
            height: 400px;
            text-align: center;
            font-size: x-large;
        }


        #userTable th {
            background-color: bisque;
            height: 45px;
            ;
        }


        .popup {

            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 200px;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .popup-content {
            background-color: rgb(255, 255, 255);
            width: 300px;
            height: 200px;
            padding: 20px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            height: 300px;
            max-width: 500px;

            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);

        }

        .close {

            color: #e96e6e;

            float: right;

            font-size: 28px;
           font-weight: bold;
            cursor: pointer;
       }
       .img{
        max-width: 300px;
        max-height: 500px;
        float: right;
       }

        .clearfix::after {
            content: '';
            clear: both;
           display: table;
      }
    </style>


<script>
    function viewSingleEmployee(userid, name, age, designation, url, gender) {
       const modal = document.createElement('div');
       modal.classList.add('modal');
       const content = document.createElement('div');
       content.classList.add('modal-content');
       const closeBtn = document.createElement('span');
       closeBtn.classList.add('close');
        closeBtn.innerText = 'CLOSE';
       closeBtn.addEventListener('click', function () {
        modal.style.display = 'none';
    });

   
    const img = document.createElement('img');
    img.src = url;
    img.classList.add('img'); 

    
    const detailsDiv = document.createElement('div');
    detailsDiv.innerHTML = `<h2>Employee Details</h2>
                            <p><strong>User ID:</strong> ${userid}</p>
                            <p><strong>Name:</strong> ${name}</p>
                            <p><strong>Age:</strong> ${age}</p>
                            <p><strong>Designation:</strong> ${designation}</p>
                            <p><strong>Gender:</strong> ${gender}</p>`;

    
    content.appendChild(img);
    content.appendChild(detailsDiv);
    content.appendChild(closeBtn);

    modal.appendChild(content);
    document.body.appendChild(modal);
    modal.style.display = 'block';
    displayPopup();
}

    
    function addRow(userid, name, age, url, designation, gender) {
        
         console.log(name)
            const tableBody = document.getElementById('userTable').getElementsByTagName('tbody')[0];
            //tableBody.innerHTML = ''; 
            const newRow = tableBody.insertRow();
            newRow.insertCell().innerText = userid;
            newRow.insertCell().innerText = name;
            newRow.insertCell().innerText = age;
            newRow.insertCell().innerText = url;
            newRow.insertCell().innerText = designation;
            newRow.insertCell().innerText = gender;


            const editBtn = document.createElement('button');
            editBtn.innerText = 'Edit';
            editBtn.addEventListener('click', function () {
                console.log('Edit' + name);
                const rowData = { userid, name, age, url, designation, gender };
                localStorage.setItem('editRowData', JSON.stringify(rowData));
                window.location.href = "edit.html"
            });


          const deleteBtn = document.createElement('button');
            deleteBtn.innerText = 'Delete';
            deleteBtn.addEventListener('click', function () {
                console.log('Delete');
                deletebutton(userid)
            });


            const viewBtn = document.createElement('button');
            viewBtn.innerText = 'View';

            viewBtn.addEventListener('click', function () {

                console.log('View');

                viewSingleEmployee(userid, name, age, designation, url, gender);

            });

         const actionCell = newRow.insertCell();
        actionCell.appendChild(editBtn);
        actionCell.appendChild(deleteBtn);
        actionCell.appendChild(viewBtn);
    }


        function loadTable() {
            const data = JSON.parse(localStorage.getItem("userData")) || [];
             console.log(data)

            data.forEach(item => {
               //console.log(item)
                const {
                    userid,
                    name,
                    age,
                    url,
                    designation,
                    gender
                } = item;
                addRow(userid, name, age, url, designation, gender);
            });
        }

        loadTable();

        function displayPopup(par) { // Added 'par' as an argument

            row = par.parentElement.parentElement;
            userid = row.cells[0].innerHTML;
            var userid = 0;

            const popup = document.getElementById('popup');

            const popupContent = document.getElementById('popup-content');

            // Populate the popup content with the employee details

            const data = JSON.parse(localStorage.getItem('userData')) || [];

            const employee = data.find(item => item.userid === userid);

            const name = data[employee].name;

            const age = data[employee].age;

            // const url = data[employee].url;

            const designation = data[employee].designation;

            const gender = data[employee].gender;

            popupContent.innerHTML = ` <h2>Employee Details</h2> <p><strong>Name:</strong> ${name}</p> <p><strong>Age:</strong> ${age}</p> <p><strong>URL:</strong> ${url}</p> <p><strong>Designation:</strong> ${designation}</p> <p><strong>Gender:</strong> ${gender}</p>  <br><button onclick="closePopup()">Close</button>  `;

            // Display the popup

            popup.style.display = 'block';

        }
        function closePopup() {

            const popup = document.getElementById('popup');
            popup.style.display = 'none';
        }

        function deletebutton(userid){

        if (confirm('delete the record?')) {

        const userData = JSON.parse(localStorage.getItem('userData')) || [];

       const dataindex = userData.findIndex(item => item.userid == userid);

       userData.splice(dataindex,1);

       localStorage.setItem('userData',JSON.stringify(userData));

       location.reload();

  } else {

  }

}
    </script>



    <div id="popup" class="popup">

        <div id="popup-content" class="popup-content">

            Employee details will be dynamically populated here
            <h2>Employee Details</h2>
            <p><strong>Name:</strong> </p>
            <p><strong>Age:</strong> </p>
            <!-- <p><strong>URL:</strong> </p> -->
            <p><strong>Designation:</strong> </p>
            <p><strong>Gender:</strong> </p>

           <!-- // Close button to close the popup -->
            <button onclick="closePopup()">Close</button>
        </div>

    </div>

</body>

</html>